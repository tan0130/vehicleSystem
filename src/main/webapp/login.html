<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <!--浏览器兼容-->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!--适应不同设备-->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>bootstrapt实例</title>
    <link rel="stylesheet" href="resources/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="resources/css/login.css"/>
    <script type="text/javascript" src="resources/js/jquery.min.js"></script>
    <script type="text/javascript" src="resources/js/jquery.validate.js"></script>
    <script type="text/javascrip"t src="resources/js/bootstrap.min.js"></script>

</head>

<body>
<div class="container">
    <div class="row clearfix">
        <div class="col-md-12 column">
            <div class="panel panel-primary" style="margin-top:20%;margin-left:30%;width:40%">
                <div class="panel-heading">
                    <h3 class="login-title">
                        登录界面
                    </h3>
                </div><!--end heading-->
                <div class="panel-body">
                    <div style="padding: 30px 120px 50px 80px;">
                        <form id="signform" class="bs-example bs-example-form" method="post" role="form">
                            <div class="input-group">
                                <span class="input-group-addon">工号</span>
                                <input type="text" id="id" class="form-control" placeholder="请输入工号">
                            </div>
                            <br>
                            <div class="input-group">
                                <span class="input-group-addon">密码</span>
                                <input type="password" id="password" class="form-control" placeholder="请输入密码">
                            </div>
                            <br>
                            <div id="myButtons1" style="margin-top:15px;margin-bottom: -15px">
                                <!--<button type="button" class="btn btn-primary">原始</button>-->
                                <input type="submit" class="btn btn-primary" value="登录"/>
                                <input type="reset" class="btn btn-primary" value="重置" style="margin-left:30px"/>
                                <a href=""><span style="font-size:12px;margin-top:30px">忘记密码</span></a>
                            </div>
                        </form>
                    </div>
                </div><!--end body-->
            </div><!--end 1st panel-->
        </div><!--end 1st column-->
    </div> <!--end 1st row-->
</div><!--end 1st container-->
<script type="text/javascript">
// 自定义校验id
    $.validator.addMethod("idCheck", function(value, element) {
       var id = $('#id').val();
       console.log(id);
       $.ajax({
          type: 'get',
          url: '/login/getUserById',
          async: false,
          cache: false,
          data: {
              vin: id
          },
          dataType: 'text',
          success:function(data) {
              if(data == "fail") {
                  value = false;
              } else if(data == "error") {
                  $.messager.alert("信息提示", "服务器出错了", "info");
              } else {
                  value = true;
              }
          },
           error:function() {
               $.messager.alert("信息提示", "服务器出错了", "info");
           }
       });
       return this.optional(element) || value;
    }, "用户不存在");

    // 自定义校验密码
    $.validator.addMethod("pwdCheck", function(value, element) {
        var id = $('#id').val();
        var password = $('#password').val();
        $.ajax({
           type: 'get',
           url: '/login/getUserByIdAndPwd',
           async: false,
           cache: false,
           data: {
               id: id,
               password: password
           },
           dataType: 'text',
           success:function(data) {
               if(data == "fail") {
                   value = false;
               } else if(data == "error") {
                   $.messager.alert("信息提示", "服务器出错了", "info");
               } else {
                   value = true;
               }
           },
            error:function() {
               $.messager.alert("信息提示", "服务器出错了", "info");
            }
        });
        return this.optional(element) || value;
    }, "密码不正确");

    $().ready(function() {
       $('#signform').validate({
           rules: {
                id: {
                    required: true,
                    idCheck: true
                },
                password: {
                    required: true,

                    pwdCheck: true
                }
           },
           messages: {
                id: {
                    required: "请输入工号",
                    idCheck: "用户不存在"
                },
                password: {
                    required: "请输入密码",
                    pwdCheck: "密码不正确"
                }
           },
           submitHandler:function() {
               window.location.href = "/login/toPage";
           }
       });
    });
</script>
</body>
</html>
